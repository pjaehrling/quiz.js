function Player(){this.score=0,this.isActive=!1}function Question(t,i,e){this.text=t,this.answers=i,this.correctIndex=e,this.isLocked=!1}function Quiz(t,i){this.topic="",this.players=[],this.questions=[],this.questionIndex=0,this.questionTime=60,this.answerTime=30,this.pointsByAnswer=1,this.secondsLeft=0,this.runningTimer=null,this.timerCallback=i;for(var e=0;t>e;e++)this.players.push(new Player)}Player.prototype.addPoints=function(t){this.score+=t},Player.prototype.setActive=function(){this.isActive=!0},Player.prototype.setUnactive=function(){this.isActive=!1},Question.prototype.answer=function(t){return this.isLocked&&t===this.correctIndex?!0:!1},Question.prototype.lock=function(){return this.isLocked?!1:(this.isLocked=!0,!0)},Question.prototype.unlock=function(){return this.isLocked?(this.isLocked=!1,!0):!1},Quiz.prototype.getQuestion=function(){return"undefined"!=typeof this.questions[this.questionIndex]?(this.startTimer(this.questionTime),this.questions[this.questionIndex]):void 0},Quiz.prototype.getPoints=function(){for(var t=[],i=0;i<this.players.length;i++)t.push(this.players[i].score);return t},Quiz.prototype.getTopic=function(){return this.topic},Quiz.prototype.setNextQuestion=function(){this.questionIndex<this.questions.length-1?(this.questionIndex++,document.dispatchEvent(new Event("newQuestion"))):(clearTimeout(this.runningTimer),document.dispatchEvent(new Event("gameEnd")))},Quiz.prototype.distributePointsToActivePlayer=function(){for(var t=0;t<this.players.length;t++)if(this.players[t].isActive){this.players[t].addPoints(1),this.players[t].setUnactive();break}},Quiz.prototype.distributePointsToUnactiveGroup=function(){for(var t=0;t<this.players.length;t++)this.players[t].isActive?this.players[t].setUnactive():this.players[t].addPoints(1)},Quiz.prototype.solveQuestion=function(t,i,e){var s=this.questions[this.questionIndex];s.isLocked&&(s.answer(t)?(this.distributePointsToActivePlayer(),i()):(this.distributePointsToUnactiveGroup(),e()),this.setNextQuestion())},Quiz.prototype.lockQuestion=function(t){return this.questions[this.questionIndex].isLocked?!1:(this.questions[this.questionIndex].lock(),this.players[t].setActive(),this.startTimer(this.answerTime),!0)},Quiz.prototype.startTimer=function(t){clearTimeout(this.runningTimer),this.secondsLeft=t,this.runTimer()},Quiz.prototype.runTimer=function(){this.secondsLeft>=0?(this.runningTimer=setTimeout(function(){this.runTimer()}.bind(this),1e3),this.timerCallback(this.secondsLeft),this.secondsLeft--):(this.questions[this.questionIndex].isLocked?(this.distributePointsToUnactiveGroup(),document.dispatchEvent(new Event("answerTimedOut"))):document.dispatchEvent(new Event("questionTimedOut")),this.setNextQuestion())},Quiz.prototype.validateJSON=function(t){if("undefined"==typeof t)return!1;if("string"!=typeof t.topic)return!1;if("undefined"==typeof t.questions||!Array.isArray(t.questions))return!1;for(var i=0;i<t.questions;i++){if(!t.questions[i].hasOwnProperty("text"))return!1;if(!t.questions[i].hasOwnProperty("answers"))return!1;if(!t.questions[i].hasOwnProperty("correctIndex"))return!1;if(!Array.isArray(t.questions[i].answers))return!1}return!0},Quiz.prototype.loadQuestionsFromJSON=function(t){if(!this.validateJSON(t))return!1;this.topic=t.topic;for(var i=0;i<t.questions.length;i++){var e=t.questions[i];this.questions.push(new Question(e.text,e.answers,e.correctIndex))}"undefined"==typeof t.questionTime||isNaN(t.questionTime)||(this.questionTime=t.questionTime),"undefined"==typeof t.answerTime||isNaN(t.answerTime)||(this.answerTime=t.answerTime),"undefined"==typeof t.pointsByAnswer||isNaN(t.pointsByAnswer)||(this.pointsByAnswer=t.pointsByAnswer)};